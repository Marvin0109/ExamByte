<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
    <head>
        <script type="module" id="truffle-injected" data-runtime="bkkjeefjfjcfdfifddmkdmcpmaakmelp" src="chrome-extension://bkkjeefjfjcfdfifddmkdmcpmaakmelp/./injected-script/index.js"></script>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta name="description" content="">
        <meta name="author" content="">
        <link rel="icon" href="/public/pictures/exambyteIcon.ico">

        <title>Tests Erstellen</title>

        <link rel="canonical" href="https://getbootstrap.com/docs/4.0/examples/carousel/">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

        <!-- Bootstrap core CSS -->
        <link href="/public/bootstrap-4.0.0/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom styles for this template -->
        <link href="/public/custom/index.css" rel="stylesheet">
        <link href="/public/custom/popup.css" rel="stylesheet">
    </head>

    <body>
        <!-- Navigation -->
        <header th:replace="~{navigation/navbar.html}"> </header>

        <main role="main" class="container mt-5 pt-5">

            <div class="container mt-5">
                <h1>Tests Erstellen</h1>
                <form th:action="@{/exams/examsProfessoren}" method="post" th:object="${examForm}">
                    <!-- Titel des Tests -->
                    <div class="form-group">
                        <label for="title">Titel des Tests</label>
                        <input type="text" class="form-control" id="title" th:field="*{title}" required>
                        <span class="text-danger" th:if="${#fields.hasErrors('title')}" th:errors="*{title}"></span>
                    </div>

                    <!-- Startzeit -->
                    <div class="form-group">
                        <label for="startTime">Startzeit</label>
                        <input type="datetime-local" class="form-control" id="startTime" th:field="*{start}" required>
                        <span class="text-danger" th:if:="${#fields.hasErrors('start')}" th:errors="*{start}"></span>
                    </div>

                    <!-- Endzeit -->
                    <div class="form-group">
                        <label for="endTime">Endzeit</label>
                        <input type="datetime-local" class="form-control" id="endTime" th:field="*{end}" required>
                        <span class="text-danger" th:if="${#fields.hasErrors('end')}" th:errors="*{end}"></span>
                    </div>

                    <!-- Ergebniszeit -->
                    <div class="form-group">
                        <label for="resultTime">Ergebniszeit</label>
                        <input type="datetime-local" class="form-control" id="resultTime" th:field="*{result}" required>
                        <span class="text-danger" th:if="${#fields.hasErrors('result')}" th:errors="*{result}"></span>
                    </div>

                    <!-- Fragen -->

                    <div class="form-group" th:each="frageForm, iterStat : ${examForm.fragen}">
                        <label for="frageText_${iterStat.index}">Frage</label>
                        <input type="text" class="form-control" id="frageText_${iterStat.index}"
                               th:field="*{fragen[__${iterStat.index}__].frageText}" placeholder="Frage eingeben" required>
                        <span class="text-danger" th:if="${#fields.hasErrors('fragen[__${iterStat.index}__].frageText')}"
                        th:errors="*{fragen[__${iterStat.index}__].frageText}"></span>>

                        <label for="maxPunkte_${iterStat.index}">Maximale Punkte</label>
                        <input type="number" class="form-control" id="maxPunkte_${iterStat.index}"
                               th:field="*{fragen[__${iterStat.index}__].maxPunkte}" min="1" required>
                        <span class="text-danger" th:if="${#fields.hasErrors('fragen[__${iterStat.index}__].maxPunkte')}"
                        th:errors="*{fragen[__${iterStat.index}__].maxPunkte}"></span>>}">

                        <!-- Fragetyp auswählen -->
                        <label>Frage Typ</label><br>

                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" id="type_SC_${iterStat.index}"
                                   th:field="*{fragen[__${iterStat.index}__].type}" value="SC" required>
                            <label class="form-check-label" for="type_SC_${iterStat.index}">Single Choice (SC)</label>
                        </div>

                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" id="type_MC_${iterStat.index}"
                                   th:field="*{fragen[__${iterStat.index}__].type}" value="MC">
                            <label class="form-check-label" for="type_MC_${iterStat.index}">Multiple Choice (MC)</label>
                        </div>

                        <div class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" id="type_FREITEXT_${iterStat.index}"
                                   th:field="*{fragen[__${iterStat.index}__].type}" value="FREITEXT">
                            <label class="form-check-label" for="type_FREITEXT_${iterStat.index}">Freitext</label>
                        </div>
                        <span class="text-danger" th:if="${#fields.hasErrors('fragen[__${iterStat.index}__].type')}"
                              th:errors="*{fragen[__${iterStat.index}__].type}"></span>

                        <!-- Dynamische Felder für Antworten (nur für SC und MC) -->
                        <div th:if="${frageForm.type == 'SC' or frageForm.type == 'MC'}">
                            <label for="choices">Antwortmöglichkeiten</label>
                            <input type="text" class="form-control" id="choices"
                                   th:field="*{fragen[__${iterStat.index}__].choices}"
                                   placeholder="Antwortmöglichkeiten eingeben" required/>
                            <span class="text-danger" th:if="${#fields.hasErrors('fragen[__${iterStat.index}__].choices')}"
                                  th:errors="*{fragen[__${iterStat.index}__].choices}"></span>
                        </div>

                        <div th:if="${frageForm.type == 'MC'}">
                            <label for="correctAnswers_${iterStat.index}">Richtige Antworten:</label>
                            <input type="text" class="form-control" id="correctAnswers_${iterStat.index}"
                                   th:field="*{fragen[__${iterStat.index}__].correctAnswers}"
                                   placeholder="Richtige Antwort(en) eingeben"/>
                            <span class="text-danger" th:if="${#fields.hasErrors('fragen[__${iterStat.index}__].correctAnswers')}"
                                  th:errors="*{fragen[__${iterStat.index}__].correctAnswers}"></span>
                        </div>

                        <div th:if="${frageForm.type == 'SC'}">
                            <label for="correctAnswer_${iterStat.index}">Richtige Antwort:</label>
                            <input type="text" class="form-control" id="correctAnswer_${iterStat.index}"
                                   th:field="*{fragen[__${iterStat.index}__].correctAnswer}"
                                   placeholder="Richtige Antwort eingeben"/>
                            <span class="text-danger" th:if="${#fields.hasErrors('fragen[__${iterStat.index}__].correctAnswer')}"
                                  th:errors="*{fragen[__${iterStat.index}__].correctAnswer}"></span>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <button type="submit" class="btn btn-primary">Test erstellen</button>
                </form>
            </div>

            <span th:text="${message}"></span>

        </main>

        <!-- js Imports -->
        <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.11.0/umd/popper.min.js"></script>
        <script src="/public/bootstrap-4.0.0/js/bootstrap.min.js"></script>
        <script src="/public/js/scripts.js"></script>
    </body>
</html>